before get in...
# ğŸŒ» Symmetric Cryptography <-> Asymmetric Cryptography

### âœ‰ï¸ Symmetric Cryptography
![](https://images.velog.io/images/yesterdaykite/post/c81ccd97-df72-4e01-ba27-e329be3a5a9e/image.png)
- __receiver, sender ëª¨ë‘ ê°™ì€ keyë¥¼ ê°€ì§„ë‹¤__
- secure channelë¡œ ê³µí†µ keyë¥¼ êµí™˜
- insecure channelë¡œ cipertext(C)ë¥¼ êµí™˜
- ìš©ì–´ì •ë¦¬
  - C : ciphertext
  - M : palintext
  - K : key
- ë‹¨ì 
  - ![](https://images.velog.io/images/yesterdaykite/post/364e2db6-2ae7-4773-bfab-f3e988c5ace7/image.png)
  - ì‚¬ëŒì´ ëŠ˜ì–´ë‚  ìˆ˜ë¡ 1:1ë¡œ ê°€ì§€ëŠ” ê³µí†µí‚¤ ê´€ë¦¬ê°€ í˜ë“¤ë‹¤

### âœ‰ï¸ Asymmetric Cryptography
![](https://images.velog.io/images/yesterdaykite/post/ed431659-9941-4048-aff5-6dd4f9f60beb/image.png)
- __senderëŠ” public key, receiverëŠ” private keyë¥¼ ê°€ì§„ë‹¤.__
- __public key__
  - encryptí•˜ê±°ë‚˜, signaturesë¥¼ verifyí•˜ëŠ”ë° ì“°ì„
  - ëˆ„êµ¬ë‚˜ ì•Œ ìˆ˜ ìˆë‹¤
- __private key__
  - decryptí•˜ê±°ë‚˜, sign(=create) signatures í•˜ëŠ”ë° ì“°ì„
  - ì˜¤ì§ recipientë§Œ ì•Œê³  ìˆìŒ
  - ì¥ì 
    - ![](https://images.velog.io/images/yesterdaykite/post/a4dde9a1-f4e9-4c61-bcf9-2f3723fad1f8/image.png)
    - keyê´€ë¦¬ê°€ ìš©ì´
    - digital signature ì‚¬ìš© ê°€ëŠ¥
  - íŠ¹ì§•
    - algorithmê³¼ encryption key(public key)ë§Œ ì•Œì•„ì„œëŠ”, private keyë¥¼ ì•Œì•„ë‚´ê¸° í˜ë“¤ë‹¤(=computationally infeasible to find)
    - ë°˜ë©´, í‚¤ë¥¼ ë‘ê°œ ë‹¤ ì•ˆë‹¤ë©´ en/decrypt í•˜ê¸° ì‰½ë‹¤
  - í™œìš©
    - encrypt & decrypt
    - digital signature
    - key exchange (messageê°€ ì•„ë‹ˆë¼ key êµí™˜)
 # ğŸŒ» Security of Public key algorithm
 - íŠ¹ì§•
   - key spaceê°€ ì¶©ë¶„íˆ ë„“ì–´ì•¼í•¨
     - 512bits, 1024bits...
   - ë§¤ìš° í° ìˆ«ìë“¤ì˜ ì—°ì‚°ì´ í•„ìš”í•¨-> symmetric key schemesì— ë¹„í•´ slow
   - known hard problemì— relyí•¨
 - __known hard problem : "trapdoor function"__
   - ë“¤ì–´ê°ˆë• ë§˜ëŒ€ë¡œì§€ë§Œ ë‚˜ê°ˆë• ì•„ë‹ˆë€ë‹¤ (ex)ì‹ì¶©ì‹ë¬¼)
   - ![](https://images.velog.io/images/yesterdaykite/post/418d1f3b-f44b-4e5d-9a65-d0afd4d23399/image.png)
     - ì˜ˆì‹œ
       - prime factorization
         - ë‘ê°œì˜ í° ìˆ˜ì¸ p, q ìˆì„ë•Œ, pq=z ê³„ì‚°í•˜ê¸° ì‰½ì§€ë§Œ, zì—ì„œ pì™€ që¥¼ ì—­ìœ¼ë¡œ ë½‘ì•„ë‚´ê¸°ëŠ” í˜ë“¤ë‹¤
         - EX) RSA, Paillier, etc..
       - discrete logarithm problem
         - ë‘ê°œì˜ ì •ìˆ˜ gì™€ xê°€ ìˆì„ë•Œ, $$a=G^XmodP$$ ê³„ì‚°í•˜ê¸° ì‰½ì§€ë§Œ, xê°€ ì£¼ì–´ì¡Œì„ë•Œ gì™€ aë¥¼ ì—­ìœ¼ë¡œ ì•Œê¸°ëŠ” ì–´ë µë‹¤
         - Diffie-Hellman, Digital Signature, Elliptic Curve, ElGamal, etc..
         - Other
           - Naccache-Stern(Knapsack), Algebraic Erase(Matrix Permutation), HFE (Multivariate Quadratic Equation), etc..
   - ë” ë„“ê²Œ spreadë  ìˆ˜ë¡ more secureí•˜ë‹¤

 # ğŸŒ» RSA
 ### INTRO
 - RSAì˜ ìˆ˜í•™ì  ë°°ê²½
 - RSA cryptosystem
 - RSA digital signature
 - RSA cryptanalysis


 ## ğŸ¦‹ RSAì˜ ìˆ˜í•™ì  ë°°ê²½
 - > __Fermat's Theorem__
   $$a^{p-1}=1(mod$$ $$p)$$
   where p is prime and gcd(a,p) = 1
   also, $$a^p = a(mod$$ $$p)$$


   - primality testing(ì†Œìˆ˜ ì²´í¬)ì— ë§¤ìš° ìœ ìš©í•˜ë‹¤.
 - >__Euler's Theorem__
   $$a^{\varphi (n)}=1(mod$$ $$n)$$
   for any a, n where gcd(a,n)=1
   $$\varphi (p)=p-1$$(ì†Œìˆ˜ì¼ë•Œ) / $$pq$$ (ì†Œìˆ˜ p*që¡œ ì´ë£¨ì–´ì¡Œì„ë•Œ)

   - example
     - a = 3, n=10, $$\varphi (10)=4$$ì¼ë•Œ,
       $$3^4=81$$=1 mod 10

## ğŸ¦‹ __testing for primality__
   - RSAí¬í•¨ ë§ì€ cyptographic algorithmë“¤ì€ very large prime numbersë¥¼ ëœë¤ìœ¼ë¡œ ê³ ë¥´ëŠ” ê²½ìš°ê°€ ë§ë‹¤.
   - "there are infinitely many primes"
   - > __nì´í•˜ì˜ prime number ëª‡ê°œë‚˜ ìˆì„ê¹Œ?__
      $$\pi(N) = n$$ë³´ë‹¤ ì‘ì€ prime numì˜ ê°¯ìˆ˜
      - $$\pi(N)\sim \frac{N}{lnN}$$
      - $$\pi(N)\sim \int^{n}_{2}{\frac{1}{ln t}dt}$$


      - $$2^{128}$$ ì´í•˜ì˜ ì†Œìˆ˜ëŠ” ëª‡ê°œ ìˆì„ê¹Œ? -> $$2^{128}\sim3.4\times 10^{38}$$ -> 3838
    - __ì‹œê°„ë³µì¡ë„__
      - naiveí•˜ê²Œ ëª¨ë“ ê²½ìš° ì‹œë„í• ë• O(n)
      - __nì—ê²Œ n/2ë³´ë‹¤ í° prime numì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¨ê±¸__ ì•Œì•˜ì„ë•Œì˜ ì‹œê°„ë³µì¡ë„ëŠ” $$O(\sqrt{n})$$

   - >__ì£¼ì–´ì§„ pê°€ primeì¸ì§€ íŒë‹¨í•˜ëŠ”ë²•__
     $$a^{p-1}=1(mod$$ $$p)$$ ì´ ì„±ë¦½í•˜ë©´ pëŠ” ì†Œìˆ˜, ì„±ë¦½í•˜ì§€ ì•Šìœ¼ë©´ ì†Œìˆ˜ê°€ ì•„ë‹˜
     aëŠ” pë³´ë‹¤ ì‘ì€ random numì„ ë§ì´ ê³¨ë¼ì„œ, í…ŒìŠ¤íŠ¸í•´ë³¸ë‹¤.
       - ê³µì‹ì„±ë¦½ = probabily prime
       - ê³µì‹ì„±ë¦½ X = not prime

   - ì˜ˆì‹œ)
     n=221ì€ ì†Œìˆ˜ì¸ê°€?
     1<a<221 ì‚¬ì´ì—ì„œ aë¥¼ ranomly pick.
     a = 38ì¼ë•Œ, $$a^{n-1}=38^{220}=1(mod221)$$
     221ì€ __prime numì¼ìˆ˜ë„ ìˆë‹¤__
     a = 26ì¼ë•Œ, $$a^{n-1}=26^220=169\neq 1(mod221)$$
     221ì€ __primeì´ ì•„ë‹ˆë‹¤__

  - >__Miller-Rabin algorithm__
    odd integer n>2ê°€ ìˆì„ë•Œ,
    n-1 ì€ $$n-1=2^{k}q$$ë¡œ í‘œí˜„ë  ìˆ˜ ìˆë‹¤.
    ë‹¨, k>0ì´ë©° qëŠ” odd ì´ë‹¤.

    > __prime numê³¼ ê³µì‹ í•©ì¹  ì‹œ prime num test__
    nì´ prime numì¸ì§€ í™•ì¸í•˜ë ¤ë©´ , ë‘ê°€ì§€ í™•ì¸í•´ì•¼
    - ì¡°ê±´1) $$a^q=$$1 mod n
    - ì¡°ê±´2) $$a^{2^{k-1}q}$$=-1 mod n = n-1 mod n
    (ë‹¨, qëŠ” í™€ìˆ˜, k>0ì´ë‹¤.)
    - ì¡°ê±´1O OR ì¡°ê±´2O = __probably prime__
    - ì¡°ê±´1X OR ì¡°ê±´2X = __not a prime__

    - ë„ì¶œê³¼ì •
        $$a^{n-1}=1$$ mod n
    -> $$a^{n-1}-1= 0$$ mod n
    -> $$a^{2^kq}-1$$ = 0 mod n

    - __miller labin algorithm í™œìš©í•œ ì†Œìˆ˜ ê²€ì‚¬ ì½”ë“œ__
      ```
      # repeat for primality testing!
      MILLER-RABIN(n):
      1. Find integers k>0, q odd, so that n-1 = (2^k)q
      2. Select a random integer a, 1 < a < n-1
      3. if a^q mod n = 1, then return 'probably prime'
      4. for j = 0 to k-1 do
         if a^{{2^j}q}mod n = n-1, then return 'probabily prime
      5. return 'composite' // not prime
      ```
    - ì˜ˆì‹œ
    ![](https://images.velog.io/images/yesterdaykite/post/43013641-ab3e-4312-819b-4793ade798e4/image.png)


### Integer Fctorization Problem
- input and output
  - input : N
    - Nì€ odd composite integer ì´ë©°,
    - Nì€ pqì™€ ê°™ì´ at least two distinct prime factorsë¡œ ì´ë£¨ì–´ì ¸ìˆë‹¤.
  - output
    - __primes p and q__
- large N is difficult!
  - p,qê°€ ì£¼ì–´ì§€ë©´ N=pqë¥¼ ê³„ì‚°í•˜ëŠ”ê±´ ì‰½ë‹¤.
  - Nì´ ì£¼ì–´ì§€ê³ , p,që¥¼ ê³„ì‚°í•´ë‚´ëŠ”ê²ƒì€
    - Nì´ ì‘ì„ë• ì‰½ê³ 
    - Nì´ í´ë• ë§¤ìš° ì–´ë µë‹¤

## ğŸ¦‹ RSA ë™ì‘ ê³¼ì •

- > ğŸ˜Š generating RSA keys
  __public key__ : (n, e)
  __private key__ : (n, d)

  - p and q are large primes!
  - n = pq
  - $$\varphi(n)=(p-1)(q-1)$$
  - ğŸ’¬ 1 < __e__ < $$\varphi(n)$$ ì´ê³ ,
    gcd(e,$$\varphi(n)$$)=1 ì¸ ì •ìˆ˜ eëŠ”
    public key ì— ì‚¬ìš©!
  - ğŸ’¬ 1 < __d__ < $$\varphi(n)$$ ì´ê³ ,
    ed=1(mod $$\varphi(n)$$) ì¸ ì •ìˆ˜ dëŠ”
    private key ì— ì‚¬ìš©!
    - dëŠ” modulo $$\varphi(n)$$ ì—ì„œ eì˜ inverseì´ë‹¤.
    - extended Euclidean algorithmìœ¼ë¡œ ê³„ì‚° ê°€ëŠ¥

- > __Encryption__ : $$c=m^e$$ mod $$n$$
    __Decryption__ : $$m = c^d$$ mod $$n$$
    (m = plaintext, c = ciphertext)

  ![](https://images.velog.io/images/yesterdaykite/post/34409dee-74c4-4cae-b61b-1b090d680747/image.png)

- example
  - ![](https://images.velog.io/images/yesterdaykite/post/6b6c6506-06a4-4c9b-93f7-db701c3e4793/image.png)
  - ![](https://images.velog.io/images/yesterdaykite/post/93f956d4-e664-4ef6-84af-83379b2e81ad/image.png)

## ğŸ¦‹ RSA ì£¼ì˜ì‚¬í•­
- currently..
  - 1024bit-RSA(309 digits) ê°€ ì£¼ë¡œ ì“°ì¸ë‹¤.
- __|p-q| ëŠ” ê°€ê¸‰ì  ì»¤ì•¼í•œë‹¤. __
- __n=pqëŠ” ì¤‘ë³µë˜ì–´ì„œëŠ” ì•ˆëœë‹¤. __
  - common modulus attack ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸
    ![](https://images.velog.io/images/yesterdaykite/post/63ceb5db-c46a-4274-ba6f-22d9206e59cb/image.png)
- __$$\varphi(n)$$__ê³¼ nì„ ì•Œë©´ attackerê°€ unknwon pë¥¼ í’€ìˆ˜ ìˆë‹¤.
  - ![](https://images.velog.io/images/yesterdaykite/post/33f5c4bd-0e60-4df5-acbb-3680b1924973/image.png)

# ğŸŒ» Implemented RSA

### âœ‰ï¸ hasing is required in RSA!
- with a hash padding,
the receiver can detect __wether the message has been modified during transmission__
![](https://images.velog.io/images/yesterdaykite/post/29ef0e24-26b7-4f39-a6d0-368879570a8b/image.png)

### âœ‰ï¸ How to encrypt a long message! -> AESì™€ ì„ì–´ì“°ì!
![](https://images.velog.io/images/yesterdaykite/post/026f32eb-4335-4297-8b32-4214f30477d8/image.png)
- ìœ„ì˜ ê·¸ë¦¼ì²˜ëŸ¼ m(ë©”ì„¸ì§€)ì´ në³´ë‹¤ ì‘ì€ $$m_1, m_2, ......, m_i$$ ë“¤ë¡œ ìª¼ê°œì¡Œì„ë•Œ __efficiency problem__ ë°œìƒ

- symmetric ê³¼ì˜ ë¹„êµ
![](https://images.velog.io/images/yesterdaykite/post/82f0796d-565b-46eb-8478-5b41b7bc5597/image.png)
|encryption algorithm|speed|shared secret key|
|---|---|---|
|__symmetric__ ex)AES|__FAST__|YES (need sharing a secret key __in advance__)|
|__RSA__|__SLOW__(100~1000ë°°ì •ë„ ëŠë ¤ì„œ, ì§§ì€ í¬ê¸°ì˜ message encryptionì— ì£¼ë¡œ ì“°ì„)|__NO__ (only need receiver's public key)|

- __ê¸¸ì´ì— ë”°ë¼ AESì™€ ì„ì–´ì“°ì !__
  ![](https://images.velog.io/images/yesterdaykite/post/9564096e-cd9c-4cf0-a240-951605dab361/image.png)

## ğŸ¦‹ digital signature
![](https://images.velog.io/images/yesterdaykite/post/df76bea5-e54f-4f25-b313-06fa7789388e/image.png)
message senderëŠ” message(m)ì™€ í•¨ê»˜ signature($$\sigma$$)ë¥¼ ë³´ë‚¸ë‹¤!
receiverëŠ” ì´ë¥¼ verify í•  ìˆ˜ ìˆë‹¤!

- ì¥ì 
  - reduce size : long message mì˜ ê²½ìš°, hash(m)=h(m)ì˜ ê¸¸ì´ëŠ” í›¨ì”¬ ì§§ë‹¤
  - improve security : attacker ì¤‘ê°„ ì¡°ì‘ ê°€ëŠ¥ì„± ì°¨ë‹¨
  ![](https://images.velog.io/images/yesterdaykite/post/446b3050-ff03-4b20-aeec-69d432c64108/image.png)
   ($$m_3$$ì€ ì¡°ì‘ëœ ë©”ì„¸ì§€ì´ë‹¤. )

### ì•ˆì „í•˜ê³  + ê¸´ ë©”ì„¸ì§€ ë³´ë‚´ê¸°
![](https://images.velog.io/images/yesterdaykite/post/d3d4cd2d-b928-40aa-80c1-8684cf5c8182/image.png)
- íš¨ê³¼
  - privacy (confidentiality)
  - data authentication (data intergrity)
  - non-repudiation
  - user authentication
